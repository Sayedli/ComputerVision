<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Face Recognition – Django</title>
    <style>
      :root{
        /* ff9933 palette */
        --bg:#fff3e6; --panel:#ffe6cc; --accent:#ff9933; --accent2:#ff8c1a; --text:#2e1f14; --muted:#7a5a3a; --border:#ffd9b3;
      }
      html,body{ height:100%; }
      body{ margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; background: radial-gradient(1200px 600px at 10% -10%, #ffe9d6 0%, var(--bg) 40%, var(--bg) 100%); color:var(--text); }
      .container{ max-width:1100px; margin: 0 auto; padding: 2rem 1rem; }
      .header h1{ margin:0 0 .25rem; }
      .subtitle{ color:var(--muted); margin:.25rem 0 1.5rem; }
      .row{ display:flex; gap:1.5rem; align-items:flex-start; flex-wrap:wrap; }
      .panel{ flex:1 1 360px; background:var(--panel); border:1px solid var(--border); border-radius:14px; padding:1rem 1.1rem; box-shadow:0 6px 20px rgba(245,158,11,.08); }
      .error{ color:#b00020; font-weight:600; }
      .btn{ background:linear-gradient(180deg, var(--accent), var(--accent2)); color:white; border:none; padding:.6rem 1rem; border-radius:10px; cursor:pointer; box-shadow:0 4px 12px rgba(255, 153, 51, .25); }
      .btn:hover{ filter:brightness(.98); }
      .link{ color:var(--accent2); text-decoration:none; margin-left:.5rem; }
      .link:hover{ text-decoration:underline; }
      table{ border-collapse:collapse; width:100%; background:white; border-radius:10px; overflow:hidden; }
      th,td{ padding:8px 10px; border-bottom:1px solid var(--border); text-align:left; }
      th{ background:#fff; }
      .footer{ color:var(--muted); margin-top:1rem; font-size:.95rem; }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>Face Recognition</h1>
      </div>

      {% if error %}<p class="error">Error: {{ error }}</p>{% endif %}
      {% if message %}<p>{{ message }}</p>{% endif %}

      <div class="row">
        <div class="panel">
          <h3>Upload Image</h3>
          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <p>
              <input type="file" name="image" accept="image/*" required />
            </p>
            <p>
              <label>Detector
                <select name="model">
                  <option value="hog">hog</option>
                  <option value="cnn">cnn</option>
                </select>
              </label>
            </p>
            <p>
              <label>Upsample <input type="number" name="upsample" value="1" min="0" max="2" style="width:4rem" /></label>
              <label style="margin-left:.5rem">Threshold <input type="number" step="0.01" name="threshold" value="0.6" style="width:5rem" /></label>
            </p>
            <p>
              <button class="btn" type="submit">Recognize</button>
              <a class="link" href="/reload">Reload Model</a>
            </p>
          </form>
          <p class="subtitle" style="margin-top:.5rem">Tip: better lighting and front‑facing photos work best.</p>
        </div>

        <div class="panel">
          <h3>Annotated Result</h3>
          {% if image_data_url %}
            <img src="{{ image_data_url }}" alt="Annotated" style="max-width: 640px; width:100%; height:auto; border-radius:10px; border:1px solid var(--border);" />
          {% else %}
            <p class="subtitle">No image yet — choose a photo to get started.</p>
          {% endif %}
        </div>
      </div>

      <h3>Detections</h3>
      {% if results %}
        <table>
          <thead><tr><th>Label</th><th>Distance</th><th>Confidence</th><th>Box (t,r,b,l)</th></tr></thead>
          <tbody>
            {% for r in results %}
              <tr>
                <td>{{ r.label }}</td>
                <td>{{ r.distance }}</td>
                <td>{{ r.confidence }}</td>
                <td>{{ r.box }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% else %}
        <p class="subtitle">No faces found.</p>
      {% endif %}

      
    </div>

  </body>
  </html>
